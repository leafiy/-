##BOM

###window对象

* 表示浏览器的一个实例

* 既是Javascript访问浏览器窗口的一个几口，也是ECAMScript中的Global对象

####全局作用域

- 全局变量不能通过 `delete` 操作符删除，而在 `window` 对象上定义的属性可以删除

```js
var age = '30'; // 使用var语句添加的属性[[Configurable]]值为false
window.age; // 30

window.color = 'red';
delete window.age; // false
delete window.color; // true

window.age; // 30
window.color; // undefined
```

- 通过 `window` 对象，可以知道可能未声明的变量是否存在

```js
var a = b; // 出错
var a = window.b; // undefined，属性查询
```

####窗口关系及框架

- 每个 `frame` 都有自己的 `window` 对象，保存在 `frames` 集合中，通过框架名称访问
- 使用框架时，存在多个 `global` 对象，因此每个框架都有一套自己的构造函数，会影响对框架传递的对象使用 `instanceof` 操作符

####窗口位置 - 略

####窗口大小

```js
//取得页面视窗的大小
var pageWidth = window.innerWidth,
	pageHeight = window.innerHeight;
if(typeof pageWidth != 'number'){
	if(document.compatMode == 'CSS1Compat'){
		pageWidth = document.documentElement.clientWidth;
		pageHeight = document.documentElement.clientHeight;
	}else{
		pageWidth = document.body.clientWidth;
		pageHeight = document.body.clientHeight;
	}
}
```

####导航和打开窗口

- `window.open()` 接收四个参数
	- URL
	- 窗口目标 `_self` `_parent` `_top` `_blank` ，如果不是一个已存在的窗口或框架，会创建一个新的窗口或标签页
	- 一个特性字符
	- 新页面是否舞台浏览器历史记录中当前加载页面的布尔值
- `close()` 方法可以关闭新打开的窗口
- 新创建的窗口（`window`对象）有一个 `opener` 属性，保存着打开它的原始窗口对象
- 窗口不会记录它们打开的窗口

```js
// 检测浏览器是否屏蔽弹出窗口（内置）
var newWindow = window.open('url','_blank');
if(newWindow == null) {
	// 弹出窗口被屏蔽
}
// 检测浏览器是否屏蔽弹出窗口（扩展程序）
var blocked = false;
try{
	var newWindow = window.open('url','_blank');
	if(newWindow == null) {
		blocked = true;
	}
}catch(ex){
	blocked = true;
}
if(blocked){s
	// 弹出窗口被屏蔽
}
```

####间歇调用和超时调用

- `setTimeout()` 和 `setInterval()` 传递字符串会造成性能损失
- JavaScript是一个单线程序的解释器，有一个JavaScript任务队列，这些任务会按照将它们添加到队列的顺序执行
- `setTimeout()` 的第二个参数表示再过多长时间把当前任务添加到队列中，如果队列是空的，那么添加的代码会立即执行；如果队列不是空的，那么它就要等前面的代码执行完了以后再执行
- 调用 `setTimeout()` 和 `setInterval()` 返回一个数值ID，可以用 `clearTimeout()` 和 `clearInterval()` 来取消未执行的调用计划

```js
var id = setTimeout(function(){
	// ....
},100);
clearTimeout(id);

var num = 0;
var max = 10;
var intervalId = null;
function incrementNum(){
	num++;
	if(num == max){
		clearInterval(intervalId);
	}
}
intervalId = setInterval(incrementNum,100);

/**以上代码等同于**/
var num = 0,max = 10;
function incrementNum(){
	num++;
	if(num < max){
		setTimeout(incrementNum,100)
	}
}
setTimeout(incrementNum,100)
```

> setTimeout调用的代码都是在全局作用域中执行的，因此函数中this的值在非严格模式下指向window对象，在严格模式下是undefined

> 使用超时调用来模拟间歇调用的是一种最佳模式。在开发环境下，很少使用真正的间歇调用，原因是后一个间歇调用可能会在前一个间歇调用结束之前启动

####系统对话框

- 浏览器通过alert()、confirm()和prompt()方法可以调用系统对话框向用户显示消息，显示这些对话框的时候代码会停止执行，而关掉这些对话框后代码又会恢复执行

###location对象

> 既是 `window` 对象的属性，也是 `document` 对象的属性；`window.location` 和 `document.location` 引用的是同一个对象。`location` 对象的用处不只表现在它保存着当前文档的信息，还表现在它将URL解析为独立的片段，让开发人员可以通过不同的属性访问这些片段


|属性名|例子|说明|
|----|----|----|
|hash|	"#contents"|	返回URL中的hash（#号后跟零或多个字符），如果URL中不包含散列，则返回空字符串|
|host|	"www.wrox.com:80"|	返回服务器名称和端口号（如果有）|
|hostname|	"www.wrox.com"|	返回不带端口号的服务器名称|
|href|	"http:/www.wrox.com"|	返回当前加载页面的完整URL。而location对象的toString()方法也返回这个值|
|pathname|	"/WileyCDA/"|	返回URL中的目录和（或）文件名|
|port|	"8080"|	返回URL中指定的端口号。如果URL中不包含端口号，则这个属性返回空字符串|
|protocol|	"http:"|	返回页面使用的协议。通常是http:或https:|
|search|	"?q=javascript"|	返回URL的查询字符串。这个字符串以问号开头|

####查询字符串参数

```js
function queryURLArgs(){
	var qs = (location.search.length > 0 ? location.search.substring(1) : "");
	var args = [];
	var items = qs.length ? qs.split('&') : [];
	var item,name,value;
	for(var i = 0;i < items.length; i++){
		item = items[i].split('=');
		name = decodeURIComponent(item[0]);
		value = decodeURIComponent(item[1]);
		if(name.length){
			args[name] = value;
		}
	}
	return args;
}
```

####位置操作

- 改变浏览器位置 `location.assign('url')` = `window.location = 'url'` 或 `location.href = 'url`（常用）
- 修改URL-hash `location.hash('tag')`
- 修改URL-查询 `location.search('?q=str')`
- 修改URL-服务器名 `location.hostname('google.com')`
- 修改URL-目录 `location.pathname('str')`
- 修改URL-端口 `location.port('888')`
- 每次修改 `location` （ `hash` 除外），会重新加载新的URL

*以上所有修改都会在历史纪录中生成一条新纪录，可以用 `replace()` 禁用*
- `location.replace('new url')` 不可后退
- `location.reload()` 重新加载（有可能从缓存中） `location.reload(true)` 从服务器加载

###navigator对象 - 略

####检测插件 - 略

####注册处理程序 - 略

###Screen对象 - 用处不大 -略

###History对象

- `history` 保存用户的上网历史纪录，是 `window` 对象的属性

```js
history.go(-1); // 后退一页
history.go(1); // 前进一页
history.go(2); // 前进2页
history.go('google.com'); // 跳转到最近的google页面
history.back(); // 后退一页
history.forward(); // 前进一页
history.length; // 历史纪录数量，如果是0，则为打开窗口后的第一个页面
```